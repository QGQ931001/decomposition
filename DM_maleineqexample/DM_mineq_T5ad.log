---------------------------------------------------------------------------------------------------------
       log:  C:\Projects\FFL\DM1\DM_mineq_T5ad.log
  log type:  text
 opened on:  29 Apr 2010, 15:51:55

. ******;
. use usmen0305_occ;

. gen time=1;

. append using usmen8385_occ ;

. replace time=0 if time~=1;
(232784 real changes made)

. rename lwage1 lwage;

. sort time;

. ***first get raw wage differentials, variance and gini;
. sum lwage [weight=eweight] if time==1, detail;
(analytic weights assumed)

                            lwage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .6579609       .0021976
 5%      .914354        .003168
10%     1.053047       .0050538       Obs              170693
25%     1.351108       .0077748       Sum of Wgt.  1.4213e+09

50%       1.7774                      Mean           1.807699
                        Largest       Std. Dev.      .5948336
75%     2.218114       4.394967
90%     2.619378       4.452199       Variance        .353827
95%     2.857367       4.518595       Skewness       .2221369
99%     3.183481       4.579553       Kurtosis       2.633646

. gen d9010_1=r(p90)-r(p10);

. gen d9050_1=r(p90)-r(p50);

. gen d5010_1=r(p50)-r(p10);

. gen var_1=r(sd)^2;

. fastgini lwage [w=eweight] if time==1;
(sampling weights assumed)

Gini coefficient = 0.1871027

.  gen gini_1=r(gini);

.  sum lwage [weight=eweight] if time==0, detail;
(analytic weights assumed)

                            lwage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .6166071       .0001378
 5%     .8705223       .0001378
10%     .9909816       .0006496       Obs              232784
25%     1.340526        .001123       Sum of Wgt.  1.4672e+09

50%     1.788959                      Mean           1.754542
                        Largest       Std. Dev.      .5405164
75%      2.15388       4.271949
90%     2.448188       4.305188       Variance        .292158
95%     2.617515       4.392179       Skewness      -.0969389
99%     2.853653       4.440384       Kurtosis       2.470979

. gen d9010_0=r(p90)-r(p10);

. gen d9050_0=r(p90)-r(p50);

. gen d5010_0=r(p50)-r(p10);

. gen var_0=r(sd)^2;

. fastgini lwage [w=eweight] if time==0;
(sampling weights assumed)

Gini coefficient = 0.1758791

.  gen gini_0=r(gini);

.  gen cd9010=d9010_1-d9010_0;

. gen cd9050=d9050_1-d9050_0;

. gen cd5010=d5010_1-d5010_0;

. gen cvar=var_1-var_0;

. gen chgini=gini_1-gini_0;

. di " c9010=" cd9010 " c9050=" cd9050 " c5010=" cd5010 "
>   cvar=" cvar " chgini=" chgini;
 c9010=.10912478 c9050=.18274856 c5010=-.07362372   cvar=.06166905 chgini=.01122354

. *next do DFL procedure for Table 5, Panel A;
. *begin with reweighting;
. * interactions;
. gen uned0=ed0*covered;

. gen uned1=ed1*covered;

.                gen uned2=ed2*covered;

. gen uned4=ed4*covered;

. gen uned5=ed5*covered;

. gen unex1=ex1*covered;

. gen unex2=ex2*covered;

. gen unex3=ex3*covered;

. gen unex4=ex4*covered;

. gen unex6=ex6*covered;

. gen unex7=ex7*covered;

. gen unex8=ex8*covered;

. gen unex9=ex9*covered;

. *quadratic interactions;
. gen ex1ed0=ed0*ex1;

. gen ex1ed1=ed1*ex1;

.                 gen ex1ed2=ed2*ex1;

. gen ex1ed4=ed4*ex1;

. gen ex1ed5=ed5*ex1;

. gen ex2ed0=ed0*ex2;

. gen ex2ed1=ed1*ex2;

.                 gen ex2ed2=ed2*ex2;

. gen ex2ed4=ed4*ex2;

. gen ex2ed5=ed5*ex2;

. gen ex3ed0=ed0*ex3;

. gen ex3ed1=ed1*ex3;

.                 gen ex3ed2=ed2*ex3;

. gen ex3ed4=ed4*ex3;

. gen ex3ed5=ed5*ex3;

. gen ex4ed0=ed0*ex4;

. gen ex4ed1=ed1*ex4;

.                 gen ex4ed2=ed2*ex4;

. gen ex4ed4=ed4*ex4;

. gen ex4ed5=ed5*ex4;

. gen ex6ed0=ed0*ex6;

. gen ex6ed1=ed1*ex6;

.                 gen ex6ed2=ed2*ex6;

. gen ex6ed4=ed4*ex6;

. gen ex6ed5=ed5*ex6;

. gen ex7ed0=ed0*ex7;

. gen ex7ed1=ed1*ex7;

.                 gen ex7ed2=ed2*ex7;

. gen ex7ed4=ed4*ex7;

. gen ex7ed5=ed5*ex7;

. gen ex8ed0=ed0*ex8;

. gen ex8ed1=ed1*ex8;

.                 gen ex8ed2=ed2*ex8;

. gen ex8ed4=ed4*ex8;

. gen ex8ed5=ed5*ex8;

. gen ex9ed0=ed0*ex9;

. gen ex9ed1=ed1*ex9;

.                 gen ex9ed2=ed2*ex9;

. gen ex9ed4=ed4*ex9;

. gen ex9ed5=ed5*ex9;

. ***probit for year effect;
.                                    probit time covered ed0 ed1 ed3 ed4 ed5 ex1-ex4 ex6-ex9  
>     uned* unex* ex1ed* ex2ed* ex3ed* ex4ed* ex6ed* 
>     ex7ed* ex8ed* ex9ed* [iweight=eweight] ;

Iteration 0:   log likelihood = -2.002e+09
Iteration 1:   log likelihood = -1.878e+09
Iteration 2:   log likelihood = -1.877e+09
Iteration 3:   log likelihood = -1.877e+09
Iteration 4:   log likelihood = -1.877e+09

Probit regression                                 Number of obs   = 2147483647
                                                  LR chi2(67)     =  2.488e+08
                                                  Prob > chi2     =     0.0000
Log likelihood = -1.877e+09                       Pseudo R2       =     0.0622

------------------------------------------------------------------------------
        time |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     covered |  -.4231164   .0002025 -2089.52   0.000    -.4235133   -.4227195
         ed0 |  -.1181913   .0003191  -370.38   0.000    -.1188167   -.1175658
         ed1 |  -.2204873   .0002903  -759.63   0.000    -.2210562   -.2199184
         ed3 |   .2560885   .0001976  1296.21   0.000     .2557013    .2564758
         ed4 |   .3451768   .0002229  1548.29   0.000     .3447398    .3456138
         ed5 |   .0502837   .0002502   201.01   0.000     .0497934     .050774
         ex1 |  -.5352788   .0001956 -2737.03   0.000    -.5356622   -.5348955
         ex2 |  -.4838319   .0002037 -2374.72   0.000    -.4842312   -.4834326
         ex3 |  -.4353187   .0002052 -2121.19   0.000    -.4357209   -.4349165
         ex4 |  -.2831459   .0002124 -1333.39   0.000    -.2835621   -.2827297
         ex6 |   .1381133   .0002339   590.47   0.000     .1376549    .1385717
         ex7 |   .2148061   .0002492   862.12   0.000     .2143178    .2152945
         ex8 |   .0878974   .0002708   324.61   0.000     .0873667    .0884282
         ex9 |  -.0148259   .0003257   -45.52   0.000    -.0154642   -.0141877
       uned0 |   -.521677   .0003326 -1568.48   0.000    -.5223289   -.5210251
       uned1 |  -.4869248   .0002576 -1890.37   0.000    -.4874296   -.4864199
       uned2 |  -.2682374   .0001578 -1699.39   0.000    -.2685468    -.267928
       uned4 |   .1349362   .0002128   634.15   0.000     .1345192    .1353532
       uned5 |  -.0003283   .0002333    -1.41   0.159    -.0007856     .000129
       unex1 |   .2447876   .0002807   872.18   0.000     .2442375    .2453377
       unex2 |   .0832721   .0002446   340.48   0.000     .0827928    .0837515
       unex3 |  -.0119633   .0002351   -50.88   0.000    -.0124242   -.0115025
       unex4 |  -.0381993   .0002361  -161.77   0.000    -.0386622   -.0377365
       unex6 |   .1200751   .0002461   487.95   0.000     .1195928    .1205574
       unex7 |   .1712754   .0002545   673.03   0.000     .1707766    .1717742
       unex8 |    .233448   .0002802   833.26   0.000     .2328989    .2339971
       unex9 |   .1891373   .0003064   617.34   0.000     .1885368    .1897378
      ex1ed0 |  -.1845977    .000802  -230.18   0.000    -.1861695   -.1830259
      ex1ed1 |   .2867682   .0003492   821.28   0.000     .2860839    .2874526
      ex1ed2 |  -.0368805    .000249  -148.14   0.000    -.0373685   -.0363925
      ex1ed4 |  -.1153589   .0003062  -376.77   0.000     -.115959   -.1147588
      ex1ed5 |  -.2126883    .000391  -543.98   0.000    -.2134546    -.211922
      ex2ed0 |   .2584561    .000542   476.86   0.000     .2573938    .2595184
      ex2ed1 |   .1895205   .0003844   493.02   0.000      .188767    .1902739
      ex2ed2 |  -.0551287   .0002517  -219.06   0.000     -.055622   -.0546355
      ex2ed4 |  -.0847117   .0003035  -279.14   0.000    -.0853065   -.0841169
      ex2ed5 |  -.0251906   .0003454   -72.93   0.000    -.0258676   -.0245137
      ex3ed0 |   .4361277    .000476   916.23   0.000     .4351947    .4370606
      ex3ed1 |   .1882183   .0003972   473.83   0.000     .1874397    .1889968
      ex3ed2 |   .0086404   .0002544    33.96   0.000     .0081417     .009139
      ex3ed4 |  -.0180458   .0003043   -59.30   0.000    -.0186422   -.0174494
      ex3ed5 |  -.0443478   .0003394  -130.67   0.000     -.045013   -.0436826
      ex4ed0 |   .2864879    .000464   617.45   0.000     .2855785    .2873973
      ex4ed1 |   .2373819   .0004104   578.47   0.000     .2365776    .2381862
      ex4ed2 |   .1073991    .000262   409.84   0.000     .1068855    .1079127
      ex4ed4 |   .0368758   .0003171   116.28   0.000     .0362542    .0374974
      ex4ed5 |  -.0163352    .000352   -46.40   0.000    -.0170251   -.0156452
      ex6ed0 |  -.2806261   .0004754  -590.25   0.000     -.281558   -.2796943
      ex6ed1 |  -.2229803   .0004337  -514.14   0.000    -.2238303   -.2221303
      ex6ed2 |  -.0849127   .0002832  -299.79   0.000    -.0854678   -.0843576
      ex6ed4 |  -.1165578   .0003527  -330.43   0.000    -.1172492   -.1158664
      ex6ed5 |   .0000119   .0003837     0.03   0.975    -.0007401    .0007638
      ex7ed0 |  -.4867092    .000484 -1005.53   0.000    -.4876579   -.4857605
      ex7ed1 |  -.3502834   .0004559  -768.38   0.000    -.3511769   -.3493899
      ex7ed2 |  -.1970939   .0003002  -656.64   0.000    -.1976822   -.1965056
      ex7ed4 |  -.1928835   .0003714  -519.30   0.000    -.1936114   -.1921555
      ex7ed5 |  -.0409592   .0004013  -102.06   0.000    -.0417458   -.0401726
      ex8ed0 |  -.4705521   .0004986  -943.67   0.000    -.4715294   -.4695748
      ex8ed1 |  -.4930387    .000491 -1004.09   0.000    -.4940011   -.4920763
      ex8ed2 |  -.2202303   .0003277  -672.10   0.000    -.2208726   -.2195881
      ex8ed4 |  -.3183033   .0004133  -770.06   0.000    -.3191134   -.3174931
      ex8ed5 |   .0040914   .0004622     8.85   0.000     .0031855    .0049973
      ex9ed0 |  -.6479773    .000482 -1344.45   0.000    -.6489219   -.6470326
      ex9ed1 |  -.4334659   .0004911  -882.58   0.000    -.4344285   -.4325033
      ex9ed2 |  -.1796185   .0003801  -472.54   0.000    -.1803635   -.1788735
      ex9ed4 |  -.1980057   .0005962  -332.12   0.000    -.1991742   -.1968372
      ex9ed5 |   .0718786   .0009776    73.52   0.000     .0699625    .0737947
       _cons |   .2562957   .0001309  1958.34   0.000     .2560392    .2565522
------------------------------------------------------------------------------

. predict py0305, p;

. summ py0305 , detail;

                          Pr(time)
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .1285449       .0999603
 5%      .200021       .0999603
10%     .3294661       .0999603       Obs              403477
25%     .3967446       .0999603       Sum of Wgt.      403477

50%     .4960283                      Mean            .489525
                        Largest       Std. Dev.      .1447998
75%     .6011387       .7664453
90%     .6937438       .7664453       Variance        .020967
95%     .7333669       .7664453       Skewness      -.2317644
99%     .7664453       .7664453       Kurtosis       2.750263

. summ time [weight=eweight] ;
(analytic weights assumed)

    Variable |     Obs      Weight        Mean   Std. Dev.       Min        Max
-------------+-----------------------------------------------------------------
        time |  403477  2.8886e+09    .4920568   .4999375          0          1

. gen pbar=r(mean);

. gen phix0=(py0305)/(1-py0305)*((1-pbar)/pbar) if time==0;
(170693 missing values generated)

. */sample weighted*/;
. replace phix0=phix0*eweight;
(232784 real changes made)

.     sum lwage [weight=phix0] if time==0, detail;
(analytic weights assumed)

                            lwage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .6566553       .0001378
 5%     .8867571       .0001378
10%     1.034844       .0006496       Obs              232784
25%      1.42345        .001123       Sum of Wgt.  1.4676e+09

50%     1.889302                      Mean           1.837516
                        Largest       Std. Dev.      .5594483
75%     2.251258       4.271949
90%     2.567621       4.305188       Variance       .3129824
95%     2.704338       4.392179       Skewness      -.1746132
99%     2.885741       4.440384       Kurtosis       2.432989

.   gen d9010_01=r(p90)-r(p10);

.   gen d9050_01=r(p90)-r(p50);

.   gen d5010_01=r(p50)-r(p10);

.   gen var_01=r(sd)^2;

.   fastgini lwage [w=phix0] if time==0;
(sampling weights assumed)
(170693 missing values generated)

Gini coefficient = 0.1739145

.   gen gini_01=r(gini);

.       gen chginic=(gini_01-gini_0);

. * get composition effects as Fc:F01-F0;
.   gen cad9010c1=(d9010_01-d9010_0);

.   gen cad9050c1=(d9050_01-d9050_0);

.   gen cad5010c1=(d5010_01-d5010_0);

.   gen cavarc1=var_01-var_0;

.   di " c9010=" cad9010c1 " c9050=" cad9050c1 " c5010=" cad5010c1 " 
>        cvar=" cavarc1 " cgini=" chginic;
 c9010=.07557046 c9050=.01909018 c5010=.05648035         cvar=.0208244 cgini=-.00196466

. * do RIF regressions without reweighing for Table 5, Panel D and Table 6;
. forvalues qt = 10(40)90 {       ;
  2.    gen rif1_`qt'=.;
  3.  gen rif0_`qt'=.;
  4.  gen rifc_`qt'=.;
  5. };
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)
(403477 missing values generated)

. sort time;

. pctile eval=lwage if time==1 [aweight=eweight], nq(100) ;

. kdensity lwage [aweight=eweight] if time==1, at(eval) gen(evalt1 denst1) width(0.065) nograph ;

. forvalues qt = 10(40)90 {       ;
  2.  local qc = `qt'/100.0;
  3.  replace rif1_`qt'=evalt1[`qt']+`qc'/denst1[`qt'] if lwage>=evalt1[`qt'] & time==1;
  4.  replace rif1_`qt'=evalt1[`qt']-(1-`qc')/denst1[`qt'] if lwage<evalt1[`qt']& time==1;
  5. };
(154636 real changes made)
(16057 real changes made)
(86527 real changes made)
(84166 real changes made)
(16544 real changes made)
(154149 real changes made)

. sum rif1* [aweight=eweight];

    Variable |     Obs      Weight        Mean   Std. Dev.       Min        Max
-------------+-----------------------------------------------------------------
     rif1_10 |  170693  1.4213e+09    1.053063   .7103329  -1.078008   1.289831
     rif1_50 |  170693  1.4213e+09    1.777591   .8092918   .9681107    2.58669
     rif1_90 |  170693  1.4213e+09    2.619501   1.125832   2.244157   5.996373

. drop eval;

. pctile eval=lwage if time==0 [aweight=eweight], nq(100) ;

. kdensity lwage [aweight=eweight] if time==0, at(eval) gen(evalt0 denst0) width(0.065) nograph ;

.  forvalues qt = 10(40)90 {      ;
  2.  local qc = `qt'/100.0;
  3.  replace rif0_`qt'=evalt0[`qt']+`qc'/denst0[`qt'] if lwage>=evalt0[`qt'] & time==0;
  4.  replace rif0_`qt'=evalt0[`qt']-(1-`qc')/denst0[`qt'] if lwage<evalt0[`qt']& time==0;
  5. };
(209652 real changes made)
(23132 real changes made)
(116674 real changes made)
(116110 real changes made)
(23691 real changes made)
(209093 real changes made)

. gen rifat=.;
(403477 missing values generated)

. forvalues qt = 10(40)90 {       ;
  2.  display "doing quantile " `qt';
  3.  replace rifat=rif0_`qt' if time==0;
  4.  replace rifat=rif1_`qt' if time==1;
  5.  oaxaca rifat covered ed0 ed1 ed3 ed4 ed5 ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 [aweight=eweight], 
>         by(time) weight(1) 
>         detail(groupun:covered,
>         grouped:ed0 ed1 ed3 ed4 ed5 ,
>         groupex:ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 );
  6.  matrix Rt`qt'=e(b);
  7.  };
doing quantile 10
(232784 real changes made)
(170693 real changes made)

Blinder-Oaxaca decomposition                      Number of obs   =     403477

           1: time = 0
           2: time = 1

------------------------------------------------------------------------------
       rifat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Differential |
Prediction_1 |   .9920635    .001558   636.73   0.000     .9890098    .9951172
Prediction_2 |   1.053063   .0017194   612.47   0.000     1.049693    1.056433
  Difference |  -.0609992   .0023203   -26.29   0.000    -.0655468   -.0564515
-------------+----------------------------------------------------------------
Explained    |
     groupun |   .0228328   .0004518    50.54   0.000     .0219473    .0237183
     grouped |  -.0433836   .0007124   -60.90   0.000    -.0447798   -.0419874
     groupex |  -.0371044   .0008626   -43.02   0.000    -.0387949   -.0354138
       Total |  -.0576552   .0012564   -45.89   0.000    -.0601177   -.0551926
-------------+----------------------------------------------------------------
Unexplained  |
     groupun |   .0093907   .0008399    11.18   0.000     .0077446    .0110368
     grouped |   .0067994   .0031313     2.17   0.030     .0006621    .0129367
     groupex |   .0016728   .0058784     0.28   0.776    -.0098486    .0131942
       _cons |  -.0212069   .0071509    -2.97   0.003    -.0352224   -.0071914
       Total |   -.003344    .002254    -1.48   0.138    -.0077618    .0010737
------------------------------------------------------------------------------
groupun: covered
grouped: ed0 ed1 ed3 ed4 ed5
groupex: ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9
doing quantile 50
(232784 real changes made)
(170693 real changes made)

Blinder-Oaxaca decomposition                      Number of obs   =     403477

           1: time = 0
           2: time = 1

------------------------------------------------------------------------------
       rifat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Differential |
Prediction_1 |   1.788965   .0016529  1082.32   0.000     1.785726    1.792205
Prediction_2 |   1.777591   .0019589   907.45   0.000     1.773752    1.781431
  Difference |   .0113738   .0025631     4.44   0.000     .0063502    .0163973
-------------+----------------------------------------------------------------
Explained    |
     groupun |   .0442861   .0006139    72.14   0.000     .0430829    .0454892
     grouped |  -.0739126   .0010373   -71.26   0.000    -.0759456   -.0718795
     groupex |  -.0603692   .0009574   -63.05   0.000    -.0622458   -.0584927
       Total |  -.0899957   .0015759   -57.11   0.000    -.0930845    -.086907
-------------+----------------------------------------------------------------
Unexplained  |
     groupun |   .0059101    .000854     6.92   0.000     .0042364    .0075839
     grouped |  -.0645793   .0031787   -20.32   0.000    -.0708094   -.0583491
     groupex |  -.0218343   .0059303    -3.68   0.000    -.0334575   -.0102111
       _cons |    .181873   .0072187    25.19   0.000     .1677246    .1960214
       Total |   .1013695   .0022813    44.43   0.000     .0968982    .1058408
------------------------------------------------------------------------------
groupun: covered
grouped: ed0 ed1 ed3 ed4 ed5
groupex: ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9
doing quantile 90
(232784 real changes made)
(170693 real changes made)

Blinder-Oaxaca decomposition                      Number of obs   =     403477

           1: time = 0
           2: time = 1

------------------------------------------------------------------------------
       rifat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Differential |
Prediction_1 |   2.448485   .0017881  1369.35   0.000     2.444981     2.45199
Prediction_2 |   2.619501   .0027251   961.25   0.000      2.61416    2.624842
  Difference |  -.1710157   .0032593   -52.47   0.000    -.1774038   -.1646275
-------------+----------------------------------------------------------------
Explained    |
     groupun |  -.0124662   .0004585   -27.19   0.000    -.0133649   -.0115675
     grouped |   -.058399   .0010896   -53.60   0.000    -.0605346   -.0562634
     groupex |  -.0485046   .0007947   -61.03   0.000    -.0500622    -.046947
       Total |  -.1193698    .001433   -83.30   0.000    -.1221784   -.1165612
-------------+----------------------------------------------------------------
Unexplained  |
     groupun |    .007476   .0012098     6.18   0.000     .0051047    .0098472
     grouped |  -.0985233   .0044396   -22.19   0.000    -.1072248   -.0898219
     groupex |  -.0098649   .0080815    -1.22   0.222    -.0257042    .0059745
       _cons |   .0492664   .0098677     4.99   0.000      .029926    .0686068
       Total |  -.0516459    .003135   -16.47   0.000    -.0577903   -.0455014
------------------------------------------------------------------------------
groupun: covered
grouped: ed0 ed1 ed3 ed4 ed5
groupex: ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9

.        matrix DR9010=Rt90-Rt10;

. matrix DR9050=Rt90-Rt50;

. matrix DR5010=Rt50-Rt10;

. matrix list DR9010;

DR9010[1,12]
     Differential:  Differential:  Differential:     Explained:     Explained:     Explained:
     Prediction_1   Prediction_2     Difference        groupun        grouped        groupex
y1      1.4564219      1.5664384      -.1100165       -.035299     -.01501543     -.01140022

        Explained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:
            Total        groupun        grouped        groupex          _cons          Total
y1     -.06171465     -.00191474     -.10532277     -.01153764       .0704733     -.04830184

. matrix list DR9050;

DR9050[1,12]
     Differential:  Differential:  Differential:     Explained:     Explained:     Explained:
     Prediction_1   Prediction_2     Difference        groupun        grouped        groupex
y1      .65952023      .84190966     -.18238942     -.05675225      .01551354      .01186465

        Explained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:
            Total        groupun        grouped        groupex          _cons          Total
y1     -.02937406      .00156587     -.03394408      .01196945     -.13260662     -.15301537

. matrix list DR5010;

DR5010[1,12]
     Differential:  Differential:  Differential:     Explained:     Explained:     Explained:
     Prediction_1   Prediction_2     Difference        groupun        grouped        groupex
y1      .79690172      .72452879      .07237293      .02145325     -.03052897     -.02326487

        Explained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:   Unexplained:
            Total        groupun        grouped        groupex          _cons          Total
y1      -.0323406     -.00348061     -.07137869     -.02350709      .20307992      .10471352

. rifreg lwage covered ed0-ed1 ed3-ed5 ex1-ex4 ex6-ex9 
>    [aweight=eweight] if time==0 , var retain(rif0_var);
(170693 missing values generated)

      Source |       SS       df       MS              Number of obs =  232784
-------------+------------------------------           F( 14,232769) = 1518.34
       Model |  2445.74134    14   174.69581           Prob > F      =  0.0000
    Residual |  26781.7389 232769  .115057155          R-squared     =  0.0837
-------------+------------------------------           Adj R-squared =  0.0836
       Total |  29227.4802 232783  .125556764          Root MSE      =   .3392
------------------------------------------------------------------------------
    rif0_var |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     covered |  -.1134498   .0016437   -69.02   0.000    -.1166715   -.1102281
         ed0 |   .0728973    .003073    23.72   0.000     .0668742    .0789203
         ed1 |   .0981253   .0022741    43.15   0.000     .0936681    .1025826
         ed3 |   .0210232   .0019683    10.68   0.000     .0171655     .024881
         ed4 |   .0849179    .002299    36.94   0.000      .080412    .0894238
         ed5 |   .1843808   .0025469    72.39   0.000     .1793889    .1893726
         ex1 |   .1140165   .0028963    39.37   0.000     .1083398    .1196932
         ex2 |  -.0600833   .0028808   -20.86   0.000    -.0657295   -.0544371
         ex3 |  -.0540405   .0029106   -18.57   0.000    -.0597452   -.0483358
         ex4 |  -.0161458    .003068    -5.26   0.000    -.0221591   -.0101325
         ex6 |   .0158014   .0034313     4.61   0.000     .0090761    .0225267
         ex7 |   .0131844   .0035827     3.68   0.000     .0061623    .0202064
         ex8 |   .0116916   .0037599     3.11   0.002     .0043224    .0190608
         ex9 |  -.0304318   .0037443    -8.13   0.000    -.0377706   -.0230931
       _cons |    .271675   .0025599   106.13   0.000     .2666577    .2766923
------------------------------------------------------------------------------

. rifreg lwage covered ed0-ed1 ed3-ed5 ex1-ex4 ex6-ex9 
>    [aweight=eweight] if time==1 , var retain(rif1_var);
(232784 missing values generated)

      Source |       SS       df       MS              Number of obs =  170693
-------------+------------------------------           F( 14,170678) = 1328.60
       Model |  3430.62338    14  245.044527           Prob > F      =  0.0000
    Residual |  31479.4336 170678  .184437558          R-squared     =  0.0983
-------------+------------------------------           Adj R-squared =  0.0982
       Total |   34910.057 170692  .204520757          Root MSE      =  .42946
------------------------------------------------------------------------------
    rif1_var |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     covered |  -.1121772   .0029391   -38.17   0.000    -.1179377   -.1064167
         ed0 |   .1493594    .005266    28.36   0.000     .1390381    .1596806
         ed1 |   .1609224   .0041349    38.92   0.000     .1528181    .1690266
         ed3 |   .0201221   .0027414     7.34   0.000     .0147491    .0254952
         ed4 |   .1766098   .0030284    58.32   0.000     .1706742    .1825455
         ed5 |   .4080803   .0038125   107.04   0.000      .400608    .4155526
         ex1 |   .1212132   .0040932    29.61   0.000     .1131907    .1292358
         ex2 |  -.0572325   .0040694   -14.06   0.000    -.0652085   -.0492566
         ex3 |  -.0434581   .0040487   -10.73   0.000    -.0513935   -.0355227
         ex4 |   -.001872   .0040609    -0.46   0.645    -.0098314    .0060874
         ex6 |  -.0049809     .00412    -1.21   0.227     -.013056    .0030942
         ex7 |   .0091259     .00431     2.12   0.034     .0006784    .0175734
         ex8 |   .0161678   .0049244     3.28   0.001      .006516    .0258196
         ex9 |   .0009116   .0057289     0.16   0.874    -.0103168      .01214
       _cons |   .2664549   .0032967    80.82   0.000     .2599934    .2729164
------------------------------------------------------------------------------

. replace rifat=rif0_var if time==0;
(232784 real changes made)

. replace rifat=rif1_var if time==1;
(170693 real changes made)

. oaxaca rifat covered ed0 ed1 ed3 ed4 ed5 ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 [aweight=eweight], 
>         by(time) weight(1) 
>         detail(groupun:covered,
>         grouped:ed0 ed1 ed3 ed4 ed5 ,
>         groupex:ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 );

Blinder-Oaxaca decomposition                      Number of obs   =     403477

           1: time = 0
           2: time = 1

------------------------------------------------------------------------------
       rifat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Differential |
Prediction_1 |   .2921567   .0007344   397.80   0.000     .2907172    .2935962
Prediction_2 |   .3538249   .0010947   323.23   0.000     .3516794    .3559704
  Difference |  -.0616682   .0013182   -46.78   0.000    -.0642519   -.0590846
-------------+----------------------------------------------------------------
Explained    |
     groupun |  -.0128867   .0002352   -54.79   0.000    -.0133477   -.0124256
     grouped |  -.0013258   .0002976    -4.45   0.000    -.0019092   -.0007425
     groupex |  -.0008553   .0002898    -2.95   0.003    -.0014232   -.0002873
       Total |  -.0150678   .0004944   -30.48   0.000    -.0160368   -.0140987
-------------+----------------------------------------------------------------
Unexplained  |
     groupun |  -.0001929   .0005103    -0.38   0.706    -.0011931    .0008074
     grouped |  -.0483033   .0018758   -25.75   0.000    -.0519798   -.0446269
     groupex |  -.0033244   .0034188    -0.97   0.331    -.0100251    .0033764
       _cons |   .0052201   .0041739     1.25   0.211    -.0029606    .0134008
       Total |  -.0466005   .0013254   -35.16   0.000    -.0491982   -.0440027
------------------------------------------------------------------------------
groupun: covered
grouped: ed0 ed1 ed3 ed4 ed5
groupex: ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9

.       rifreg lwage covered ed0-ed1 ed3-ed5 ex1-ex4 ex6-ex9 
>    [aweight=eweight] if time==0 , gini retain(rif0_gin);

      Source |       SS       df       MS              Number of obs =  232784
-------------+------------------------------           F( 14,232769) = 4113.03
       Model |  726.203124    14  51.8716517           Prob > F      =  0.0000
    Residual |  2935.57507 232769  .012611538          R-squared     =  0.1983
-------------+------------------------------           Adj R-squared =  0.1983
       Total |   3661.7782 232783  .015730436          Root MSE      =   .1123
------------------------------------------------------------------------------
    rif0_gin |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     covered |  -.0605086   .0005442  -111.19   0.000    -.0615752    -.059442
         ed0 |   .0641799   .0010174    63.08   0.000     .0621858     .066174
         ed1 |   .0523911   .0007529    69.58   0.000     .0509154    .0538668
         ed3 |  -.0080682   .0006516   -12.38   0.000    -.0093454    -.006791
         ed4 |  -.0176337   .0007611   -23.17   0.000    -.0191255   -.0161419
         ed5 |   .0085325   .0008432    10.12   0.000     .0068798    .0101852
         ex1 |   .1009708   .0009589   105.30   0.000     .0990914    .1028502
         ex2 |   .0118356   .0009537    12.41   0.000     .0099663    .0137049
         ex3 |    -.00067   .0009636    -0.70   0.487    -.0025586    .0012187
         ex4 |   .0011858   .0010158     1.17   0.243     -.000805    .0031767
         ex6 |   .0023156    .001136     2.04   0.042      .000089    .0045422
         ex7 |   .0009019   .0011862     0.76   0.447    -.0014229    .0032267
         ex8 |  -.0008395   .0012448    -0.67   0.500    -.0032792    .0016003
         ex9 |  -.0112176   .0012397    -9.05   0.000    -.0136473   -.0087879
       _cons |   .1637937   .0008475   193.26   0.000     .1621326    .1654548
------------------------------------------------------------------------------

. rifreg lwage covered ed0-ed1 ed3-ed5 ex1-ex4 ex6-ex9 
>    [aweight=eweight] if time==1 , gini retain(rif1_gin);

      Source |       SS       df       MS              Number of obs =  170693
-------------+------------------------------           F( 14,170678) = 1996.33
       Model |  374.664199    14  26.7617285           Prob > F      =  0.0000
    Residual |  2288.02192 170678  .013405488          R-squared     =  0.1407
-------------+------------------------------           Adj R-squared =  0.1406
       Total |  2662.68612 170692  .015599361          Root MSE      =  .11578
------------------------------------------------------------------------------
    rif1_gin |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     covered |  -.0469882   .0007924   -59.30   0.000    -.0485413   -.0454352
         ed0 |   .0819962   .0014197    57.76   0.000     .0792137    .0847788
         ed1 |   .0664901   .0011148    59.65   0.000     .0643052     .068675
         ed3 |  -.0111777   .0007391   -15.12   0.000    -.0126263   -.0097292
         ed4 |  -.0032201   .0008165    -3.94   0.000    -.0048204   -.0016199
         ed5 |   .0396392   .0010278    38.57   0.000     .0376247    .0416537
         ex1 |   .0914925   .0011035    82.91   0.000     .0893296    .0936553
         ex2 |   .0123977   .0010971    11.30   0.000     .0102474     .014548
         ex3 |   .0010461   .0010915     0.96   0.338    -.0010933    .0031855
         ex4 |   .0030866   .0010948     2.82   0.005     .0009407    .0052324
         ex6 |  -.0030333   .0011107    -2.73   0.006    -.0052103   -.0008562
         ex7 |   .0019177    .001162     1.65   0.099    -.0003597    .0041952
         ex8 |    .004284   .0013276     3.23   0.001     .0016819    .0068861
         ex9 |   .0024533   .0015445     1.59   0.112    -.0005738    .0054805
       _cons |   .1700743   .0008888   191.36   0.000     .1683323    .1718163
------------------------------------------------------------------------------

. replace rifat=rif0_gin if time==0;
(232784 real changes made)

. replace rifat=rif1_gin if time==1;
(170693 real changes made)

. oaxaca rifat covered ed0 ed1 ed3 ed4 ed5 ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 [aweight=eweight], 
>         by(time) weight(1) 
>         detail(groupun:covered,
>         grouped:ed0 ed1 ed3 ed4 ed5 ,
>         groupex:ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9 );

Blinder-Oaxaca decomposition                      Number of obs   =     403477

           1: time = 0
           2: time = 1

------------------------------------------------------------------------------
       rifat |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
Differential |
Prediction_1 |   .1758792     .00026   676.57   0.000     .1753697    .1763887
Prediction_2 |   .1871027   .0003023   618.90   0.000     .1865101    .1876952
  Difference |  -.0112235   .0003987   -28.15   0.000    -.0120049    -.010442
-------------+----------------------------------------------------------------
Explained    |
     groupun |  -.0068731   .0000982   -69.99   0.000    -.0070656   -.0066806
     grouped |   .0057866   .0001079    53.62   0.000     .0055751    .0059981
     groupex |   .0048731   .0001378    35.37   0.000     .0046031    .0051431
       Total |   .0037866   .0002104    17.99   0.000     .0033741     .004199
-------------+----------------------------------------------------------------
Unexplained  |
     groupun |   -.002049   .0001461   -14.02   0.000    -.0023354   -.0017625
     grouped |  -.0069982   .0005416   -12.92   0.000    -.0080598   -.0059366
     groupex |   .0003177   .0010086     0.32   0.753    -.0016591    .0022945
       _cons |  -.0062806   .0012281    -5.11   0.000    -.0086876   -.0038735
       Total |    -.01501   .0003879   -38.69   0.000    -.0157704   -.0142497
------------------------------------------------------------------------------
groupun: covered
grouped: ed0 ed1 ed3 ed4 ed5
groupex: ex1 ex2 ex3 ex4 ex6 ex7 ex8 ex9

. 
end of do-file

